---
title: "scicur-study1"
output: html_document
---

# Libraries
```{r message=F, warning=F}
library(rio)
library(here)
library(tidyverse)
library(janitor)
```

# Baseline Data
```{r}
dfm_bp <- import(here("data", "baselinep-data.csv")) %>% 
  clean_names() %>% 
  rename(., "id" = "amazon_identifier") %>% 
  mutate(batch = "basep")

dfm_b1 <- import(here("data", "baseline1-data.csv")) %>% 
  clean_names() %>% 
  rename(., "id" = "amazon_identifier") %>% 
  mutate(batch = "base1")

dfq_b <- import(here("data", "qual-baseline-data.csv")) %>% 
  clean_names()
```

```{r}
dfm_b <- rbind(dfm_bp, dfm_b1)
```

```{r}
dfm_b_dup <- dfm_b %>% 
  group_by(id) %>% 
  filter(n() > 1)

dfm_b_app <- dfm_b %>% 
  filter(approval_status == "Approved")
```

```{r}
dfq_b1 <- dfq_b %>% 
  filter(id %in% dfm_b$id & !id %in% dfm_b_dup$id)
```

```{r}
dfq_b1 <- dfq_b1 %>% 
  filter(finished == 1 & consent == 1)
```

```{r}
bcols <- dfq_b1 %>% 
  colnames()

bcols1 <- rep(NA, length(bcols))

for (i in 1:length(bcols)) {
  
  bcols1[i] = paste(bcols[i], "b", sep = "_")

}

colnames(dfq_b1) <- bcols1

dfq_b1 <- dfq_b1 %>% 
  rename(., id = id_b)
```

# Sci Cur Data
```{r}
# mturk
dfm_con1 <- import(here("data", "mturk-data-con1.csv")) %>% 
  clean_names() %>% 
  rename(., "id" = "amazon_identifier") %>% 
  mutate(batch = "con1")

dfm_con2 <- import(here("data", "mturk-data-con2.csv")) %>% 
  clean_names() %>% 
  rename(., "id" = "amazon_identifier") %>% 
  mutate(batch = "con2")

dfm_lib1 <- import(here("data", "mturk-data-lib1.csv"))%>% 
  clean_names() %>% 
  rename(., "id" = "amazon_identifier") %>% 
  mutate(batch = "lib1")

dfm_lib2 <- import(here("data", "mturk-data-lib2.csv"))%>% 
  clean_names() %>% 
  rename(., "id" = "amazon_identifier") %>% 
  mutate(batch = "lib2")

# qualtrics
dfq <- import(here("data", "qual-data.csv")) %>% 
  clean_names()
```

# MTurk Data
```{r}
dfm <- rbind(dfm_con1, dfm_con2, dfm_lib1, dfm_lib2)
```

```{r}
dfm_dup <- dfm %>% 
  group_by(id) %>% 
  filter(n() > 1)

dfm_dup %>% 
  filter(approval_status == "Approved") %>% 
  select(id)

dup_idall <- c("A3CZNWMYPM3P6E", "A2YC6PEMIRSOAA", "A2BK9RMC0NOIH8", "A2V27A9GZA1NR2",
           "ARFQ8FJRKCUZ6", "A3F9IQB0297J9D", "ATTGD1M94GFR", "A2IQ0QCTQ3KWLT",
           "A2YLK83DQ6PA5Y")

dup_id <- c("A3CZNWMYPM3P6E", "A2YC6PEMIRSOAA", "A2BK9RMC0NOIH8", "A2V27A9GZA1NR2",
           "ARFQ8FJRKCUZ6", "A3F9IQB0297J9D", "ATTGD1M94GFR", "A2YLK83DQ6PA5Y")
# A2IQ0QCTQ3KWLT does have a duplicate but they accessed the survey for 19s
# before exiting so they didn't go beyond the consent page
```

```{r}
dfm_app <- dfm %>% 
  filter(approval_status == "Approved")
```

# Qualtrics Data
```{r echo=F, eval=F}
dfq_dup <- dfq %>% 
  filter(id %in% dup_id)

dfq_dup %>% 
  group_by(id) %>% 
  summarise(n = n()) %>% 
  filter(n > 1)

dfq_dup %>% 
  filter(id == "A2IQ0QCTQ3KWLT" | id == "A2YC6PEMIRSOAA" | id == "A3F9IQB0297J9D") %>% 
  select(start_date, end_date, id, finished, duration_in_seconds, consent1,
         bad_resp, cheat) 

dfq %>% 
  filter(!id %in% dup_id & id %in% dfm_app$id)
```

```{r}
dfq1 <- dfq %>% 
  filter(!id %in% dup_id & finished == 1 & cheat == 3 & bad_resp == 1 &
           consent1 == 1 & id %in% dfm_app$id)

# nEED TO CREATE A MISSINGNESS VARIABLE TO FILTER W -- LESS THAN 5%
```

```{r}
cols <- dfq1 %>% 
  colnames()

cols1 <- rep(NA, length(cols))

for (i in 1:length(cols)) {
  
  cols1[i] = paste(cols[i], "sc", sep = "_")

}

colnames(dfq1) <- cols1

dfq1 <- dfq1 %>% 
  rename(., id = id_sc)
```

```{r}
df1 <- left_join(dfq1, dfq_b1, by = "id")
```

